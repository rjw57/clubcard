"use strict";angular.module("clubcardApp",["ngCookies","ngResource","ngSanitize","ngRoute","ui.bootstrap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("clubcardApp").controller("MainCtrl",["$scope","$window","$modal",function(a,b,c){var d=this;if(a.accounts=[],b.localStorage&&b.localStorage.getItem){var e=b.localStorage.getItem("accounts");e&&(a.accounts=angular.fromJson(e))}a.$watch("accounts",function(a){void 0!==a&&null!==a&&b.localStorage&&b.localStorage.setItem&&b.localStorage.setItem("accounts",angular.toJson(a))},!0),d.openAddAccountModal=function(){c.open({templateUrl:"addAccountModalContent.html"}).result.then(function(a){d.addAccount(a)})},d.removeAccount=function(b){var c=[];angular.forEach(a.accounts,function(a){a.id!==b.id&&c.push(a)}),a.accounts=c},d.addAccount=function(b){var c=Date.now(),d={id:c,title:b.name,number:""+b.number,code:""+b.number,createdDate:Date.now()};"63400"===d.code.substr(0,5)&&(d.code="979"+d.code.substr(5)),a.accounts.push(d)}}]),angular.module("clubcardApp").directive("account",function(){return{restrict:"E",scope:{onremove:"=",account:"="},templateUrl:"account.html",controllerAs:"ctrl",controller:["$scope",function(a){var b=this;b.remove=function(){a.onremove&&a.onremove(a.account)}}]}}),angular.module("clubcardApp").directive("barcode",function(){return{template:"<img></img>",restrict:"E",scope:{code:"="},link:function(a,b){$(b).find("img").JsBarcode(""+a.code,{width:1,height:50})}}}),angular.module("clubcardApp").controller("AccountFormCtrl",["$scope",function(a){var b=this;a.account={},a.reset=function(){a.account={}},b.controlClasses=function(a){return a?{"has-error":a.$invalid&&!a.$pristine,"has-success":a.$valid&&!a.$pristine}:{}}}]);